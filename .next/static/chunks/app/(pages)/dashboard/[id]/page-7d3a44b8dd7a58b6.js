(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{1517:(e,r,a)=>{"use strict";a.d(r,{A:()=>o});var t=a(5155),s=a(8456);function o(e){return(0,t.jsx)("input",{...e,className:(0,s.cn)("text-xs sm:text-sm w-full p-3 bg-transparent text-gray-tertiary placeholder:text-gray-tertiary/0.6 rounded-xl border border-gray-tertiary/35",e.className)})}},2171:(e,r,a)=>{"use strict";a.d(r,{A:()=>o});var t=a(5155),s=a(8456);function o(e){let{children:r,variant:a="primary",...o}=e;return(0,t.jsx)("button",{...o,className:(0,s.cn)("whitespace-nowrap rounded-lg px-6 py-3 text-base","primary"===a&&"bg-yellow-primary text-beige-primary","secondary"===a&&"bg-yellow-secondary text-brown-tertiary","tertiary"===a&&"bg-beige-primary text-yellow-primary border border-yellow-primary border-4","quaternary"===a&&"bg-yellow-secondary text-beige-primary","quinary"===a&&"bg-green-primary text-beige-primary","senary"===a&&"bg-beige-primary text-yellow-secondary border border-yellow-secondary",o.className),children:r})}},3427:(e,r,a)=>{"use strict";a.d(r,{default:()=>y});var t=a(5155),s=a(2115),o=a(2171),l=a(1517),n=a(4674),i=a(5328);async function c(e){var r;let a=(await i.A.get("/meu-perfil",{headers:{Authorization:"Bearer ".concat(e)}})).data;return a.success&&(null==(r=a.user)?void 0:r.foto_perfil_url)&&(a.user.foto_perfil_url="".concat("https://54327051f610.ngrok-free.app").concat(a.user.foto_perfil_url)),a}async function u(e,r){return(await i.A.put("/meu-perfil",r,{headers:{Authorization:"Bearer ".concat(e)}})).data}async function d(e,r){let a=new FormData;return a.append("profilePhoto",r),(await i.A.post("/meu-perfil/upload-foto",a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}})).data}async function m(e){return(await i.A.delete("/meu-perfil",{headers:{Authorization:"Bearer ".concat(e)}})).data}var p=a(4744);function f(){let{token:e,logout:r}=(0,n.A)(),[a,i]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[f,h]=(0,s.useState)(""),[y,x]=(0,s.useState)(""),[g,v]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&(async()=>{try{let t=await c(e);if(t.success)i(t.user.nome_completo),m(t.user.email),h(t.user.cpf);else{var a;p.oR.error("N\xe3o foi poss\xedvel carregar perfil."),(null==(a=t.message)?void 0:a.toLowerCase().includes("token"))&&r()}}catch(e){console.error(e),p.oR.error("Erro inesperado ao carregar perfil.")}finally{p.oR.dismiss()}})()},[e,r]);let b=async r=>{if(r.preventDefault(),!e)return;let t={};if(""!==a.trim()&&(t.nome_completo=a),""!==g.trim()&&(t.senha_atual=y,t.nova_senha=g),0===Object.keys(t).length)return void p.oR.info("Nenhuma altera\xe7\xe3o para salvar.");try{let r=await u(e,t);r.success?(p.oR.success("Perfil atualizado com sucesso!"),i(r.user.nome_completo),x(""),v("")):(p.oR.error("N\xe3o foi poss\xedvel atualizar perfil."),console.error("Erro: ",r.message))}catch(e){console.error(e),p.oR.error("Erro inesperado ao atualizar perfil.")}finally{p.oR.dismiss()}};return(0,t.jsxs)("form",{onSubmit:b,className:"w-full flex flex-col gap-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"nome",className:"pb-2 font-secondary text-gray-tertiary text-base",children:"Nome Completo"}),(0,t.jsx)(l.A,{id:"nome",value:a,onChange:e=>i(e.target.value),placeholder:"Nome aqui"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"pb-2 font-secondary text-gray-tertiary text-base",children:"E-mail"}),(0,t.jsx)(l.A,{id:"email",value:d,readOnly:!0,placeholder:"Email aqui"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"cpf",className:"pb-2 font-secondary text-gray-tertiary text-base",children:"CPF cadastrado"}),(0,t.jsx)(l.A,{id:"cpf",value:f,readOnly:!0,placeholder:"CPF aqui"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"senha",className:"pb-2 font-secondary text-gray-tertiary text-base",children:"Insira sua senha atual:"}),(0,t.jsx)(l.A,{id:"senha",type:"password",value:y,onChange:e=>x(e.target.value),placeholder:"Senha aqui"})]}),(0,t.jsxs)("div",{className:"pb-36",children:[(0,t.jsx)("label",{htmlFor:"novaSenha",className:"pb-2 font-secondary text-gray-tertiary text-base",children:"Insira sua nova senha:"}),(0,t.jsx)(l.A,{id:"novaSenha",type:"password",value:g,onChange:e=>v(e.target.value),placeholder:"Confirme sua senha aqui"})]}),(0,t.jsx)(o.A,{type:"submit",variant:"quaternary",className:"w-full py-4 font-medium text-xl",children:"Atualizar meus Dados"})]})}var h=a(63);function y(){let{token:e,logout:r}=(0,n.A)(),a=(0,s.useRef)(null),[l,i]=(0,s.useState)(null),[u,y]=(0,s.useState)(!0),x=(0,h.useRouter)();(0,s.useEffect)(()=>{e&&(async()=>{try{p.oR.loading("Carregando perfil...");let t=await c(e);if(t.success)i(t.user);else{var a;p.oR.error("N\xe3o foi poss\xedvel carregar seus dados."),(null==(a=t.message)?void 0:a.toLowerCase().includes("token"))&&r()}}catch(e){console.error(e),p.oR.error("Erro inesperado ao carregar perfil.")}finally{y(!1),p.oR.dismiss()}})()},[e,r]);let g=async r=>{if(!r.target.files||0===r.target.files.length)return;let a=r.target.files[0];if(!["image/jpeg","image/png"].includes(a.type))return void p.oR.info("Apenas imagens JPEG e PNG s\xe3o permitidas.");if(a.size>1048576)return void p.oR.info("O arquivo deve ter no m\xe1ximo 1MB.");if(e)try{let r=await d(e,a);if(r.success){p.oR.success("Foto atualizada com sucesso!");let r=await c(e);r.success&&i(r.user)}else p.oR.error("N\xe3o foi poss\xedvel atualizar a foto."),console.error("Erro: ",r.message)}catch(e){console.error("Erro: ",e),p.oR.error("Erro inesperado ao enviar foto.")}finally{p.oR.dismiss()}},v=async()=>{if(e)try{let a=await m(e);a.success?(p.oR.success("Usu\xe1rio exclu\xeddo!"),r(),x.push("/")):(p.oR.error("N\xe3o foi poss\xedvel excluir usu\xe1rio"),console.error("Erro: ",a.message))}catch(e){console.error("Erro: ",e),p.oR.error("Erro inesperado ao excluir usu\xe1rio!")}finally{p.oR.dismiss()}};return u?(0,t.jsx)("p",{children:"Carregando..."}):(0,t.jsxs)("div",{className:"pl-16 py-10",children:[(0,t.jsx)("h1",{className:"text-brown-tertiary text-2xl font-secondary font-bold",children:"Informa\xe7\xf5es Pessoais:"}),(0,t.jsxs)("div",{className:"flex pt-10",children:[(0,t.jsx)("div",{className:"border-t border-r border-gray-primary w-9/12 pr-40 py-8",children:(0,t.jsx)(f,{})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-between w-5/12 pb-20",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("img",{alt:"Foto do usu\xe1rio",src:(null==l?void 0:l.foto_perfil_url)||"/user.png",className:"size-38 object-cover rounded-full border"}),(0,t.jsx)(o.A,{variant:"senary",className:"mt-6 px-6 py-3 font-medium text-base rounded-none uppercase",onClick:()=>{var e;null==(e=a.current)||e.click()},type:"button",children:"Selecionar a Imagem"}),(0,t.jsx)("input",{type:"file",accept:"image/png, image/jpeg",ref:a,onChange:g,hidden:!0}),(0,t.jsxs)("div",{className:"pt-10 text-brown-primary text-base font-secondary font-medium",children:[(0,t.jsx)("p",{children:"Tamanho do arquivo: no m\xe1ximo 1 MB"}),(0,t.jsx)("p",{children:"Extens\xe3o de arquivo: JPEG, PNG"})]})]}),(0,t.jsx)("div",{className:"flex items-center text-center pt-10 text-black text-base font-secondary font-medium",children:(0,t.jsxs)("p",{children:["Deseja excluir sua conta?"," ",(0,t.jsx)("span",{className:"underline cursor-pointer",onClick:v,children:"Clique aqui"})]})})]})]})]})}},4674:(e,r,a)=>{"use strict";a.d(r,{A:()=>u,AuthProvider:()=>c});var t=a(5155),s=a(2115),o=a(5328),l=a(63),n=a(4744);let i=(0,s.createContext)(void 0);function c(e){let{children:r}=e,[a,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(null),[m,p]=(0,s.useState)(!0),f=(0,l.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),r=localStorage.getItem("user");e&&c(e),r&&d(JSON.parse(r)),p(!1)},[]);let h=async(e,r)=>{p(!0);try{let a=await o.A.post("/users/login",{email:e,senha:r});if(a.data.success){let{token:e,user:r}=a.data;c(e),d(r),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(r));let t=localStorage.getItem("redirectAfterAuth");t?(localStorage.removeItem("redirectAfterAuth"),f.push(t)):f.push("/dashboard/".concat(r.id))}else n.oR.error("Falha ao realizar login, tente novamente!"),console.error(a.data.message)}catch(e){console.error("Erro no login:",e),n.oR.error("Falha no login. Verifique suas credenciais!")}finally{p(!1)}},y=async(e,r,a,t)=>{p(!0);try{let s=await o.A.post("/users/register",{nome_completo:e,email:r,cpf:a,senha:t});s.data.success?(n.oR.success("Cadastro realizado com sucesso!"),await h(r,t)):(n.oR.error("Falha no cadastro. Tente novamente."),console.error(s.data.message))}catch(e){console.error("Erro no cadastro:",e),n.oR.error("Falha no cadastro. Tente novamente.")}finally{p(!1)}};return(0,t.jsx)(i.Provider,{value:{isAuthenticated:!!a,login:h,loading:m,register:y,logout:()=>{c(null),d(null),localStorage.removeItem("token"),localStorage.removeItem("user"),p(!1),f.push("/")},token:a,user:u},children:r})}function u(){let e=(0,s.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},5328:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=a(5125).A.create({baseURL:"https://54327051f610.ngrok-free.app",headers:{"ngrok-skip-browser-warning":"true"}})},8456:(e,r,a)=>{"use strict";a.d(r,{cn:()=>o});var t=a(2821),s=a(5889);function o(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,s.QP)((0,t.$)(r))}},9055:(e,r,a)=>{Promise.resolve().then(a.bind(a,3427))}},e=>{e.O(0,[557,889,441,255,358],()=>e(e.s=9055)),_N_E=e.O()}]);